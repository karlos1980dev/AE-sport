<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel ADM de Códigos</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: #000;
    color: white;
  }
  .container {
    max-width: 800px;
    margin: 20px auto;
    background: purple;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 0 10px #444;
  }
  h1, h2 { color: gold; text-align: center; }
  input, button {
    padding: 10px;
    margin: 5px 0;
    width: 100%;
    box-sizing: border-box;
    border-radius: 5px;
    border: none;
  }
  button {
    background: green;
    color: white;
    cursor: pointer;
  }
  #mensagem {
    margin-top: 20px;
    padding: 10px;
    background: #eee;
    color: black;
    border-radius: 5px;
    white-space: pre-line;
    word-break: break-word;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 30px;
  }
  th, td {
    padding: 10px;
    border: 1px solid #fff;
    text-align: center;
  }
  th { background: #444; }
  tr:nth-child(even) { background: #333; }
  .btn-excluir {
    background: red;
    color: white;
    border-radius: 5px;
    cursor: pointer;
    padding: 5px 10px;
  }
</style>
</head>
<body>

<div class="container">
  <h2>Painel ADM - Gerar Códigos</h2>
  
  <label for="nivel">Valor Reais:</label>
  <input type="number" id="nivel" placeholder="VALOR R$">
  
  <input type="number" id="quantidade" placeholder="Digite a quantidade">
  
  <button id="buscar">Buscar Códigos</button>
  
  <div id="mensagem"></div>
</div>

<div class="container">
<h1>Usuários em Tempo Real</h1>
<table>
  <thead>
    <tr>
      <th>ID do Usuário</th>
      <th>Saldo (R$)</th>
      <th>Ganho Total (R$)</th>
      <th>Ação</th>
    </tr>
  </thead>
  <tbody id="usuariosTabela">
    <!-- Dados vão aparecer aqui -->
  </tbody>
</table>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

// Config Firebase
const firebaseConfig = {
  apiKey: "AIzaSyCqh1ZtEASGhNEK_8CbUiha9jPyqfwalA4",
  authDomain: "winx5-f4bd2.firebaseapp.com",
  databaseURL: "https://winx5-f4bd2-default-rtdb.firebaseio.com",
  projectId: "winx5-f4bd2",
  storageBucket: "winx5-f4bd2.appspot.com",
  messagingSenderId: "539880532364",
  appId: "1:539880532364:web:c75b0d6ac32fc6ce830ea9"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const usuariosRef = ref(db, "usuarios");

// Atualizar tabela em tempo real
onValue(usuariosRef, (snapshot) => {
    const data = snapshot.val();
    const tbody = document.getElementById("usuariosTabela");
    tbody.innerHTML = ""; // limpar tabela

    if(data){
        Object.keys(data).forEach(userId => {
            const user = data[userId];
            const tr = document.createElement("tr");
            
            const ganho = parseFloat(user.ganhoTotal || 0);
            if(ganho >= 200){
                tr.style.background = "green";
                tr.style.color = "white";
            }

            tr.innerHTML = `
                <td>${userId}</td>
                <td>R$ ${parseFloat(user.saldo || 0).toFixed(2)}</td>
                <td>R$ ${ganho.toFixed(2)}</td>
                <td><button class="btn-excluir">X</button></td>
            `;

            // Evento para excluir usuário
            tr.querySelector(".btn-excluir").addEventListener("click", () => {
                const userRef = ref(db, `usuarios/${userId}`);
                remove(userRef)
                  .then(() => alert(`Usuário ${userId} excluído com sucesso!`))
                  .catch(err => alert("Erro ao excluir: " + err));
            });

            tbody.appendChild(tr);
        });
    }
});

// --- Gerar códigos ---
const codigos = {
  50: ["716412153","592315254","846882055","14081980","195668863","653096775","504350967","635551900","286671414","732888663"],
  40: ["217565915","919970433","284338878","101696967","702396412","229654598","874019901","621211661","336075929","485986855"],
  30: ["739656665","465396613","189768712","112988692","966044328","595658876","109617524","899800853","755223289","960909265"],
  20: ["446224300","394127636","812879696","960907901","491988845","249227981","956544659","349657658","840757999","217686050"],
  10: ["691539990","811999999","108784816","313505599","806528892","366228475","716094154","592329855","846668856","504376968"],
  9:  ["874016501","621216611","336090029","485980155","635598520","286682714","732880863","195658864","653677588","129458885"],
  8:  ["956535449","003496558","840776999","217612050","739668765","466345913","189763212","112967892","904432228","595665576"],
  7:  ["673207857","209122886","487021875","337834018","596597700","387881988","978833855","699939986","767384776","560098455"],
  6:  ["673275057","209651886","487029815","337808818","596588000","367871988","309878266","317746674","507846878","999297605"],
  5:  ["986476586","443438756","978638855","699975986","767388776","005600455","647728866","878863675","441365796","965878855"],
  4:  ["109613224","899876853","755228449","960976265","216594315","919098433","284337448","101697667","702397612","229654599"],
  3:  ["309821966","317663274","507683478","929766405","446224553","394128836","887963496","960901271","491987745","249212271"],
  2:  ["647720986","878867473","441379896","987877855","691997690","811977999","108488516","313503399","806521292","366222275"],
  1:  ["teste1336263","teste00001123","teste0062526","teste97288863000","teste62527883","teste4425252517"]
    };

function pegarCodigosAleatorios(arr, n) {
  const copia = [...arr];
  const resultado = [];
  n = Math.min(n, arr.length);
  for (let i = 0; i < n; i++) {
    const idx = Math.floor(Math.random() * copia.length);
    resultado.push(copia[idx]);
    copia.splice(idx, 1);
  }
  return resultado;
}

document.getElementById("buscar").addEventListener("click", () => {
  const nivel = document.getElementById("nivel").value;
  const quantidade = parseInt(document.getElementById("quantidade").value);
  const mensagemDiv = document.getElementById("mensagem");
  
  if (!codigos[nivel]) {
    mensagemDiv.textContent = "Nível inválido!";
    return;
  }
  if (!quantidade || quantidade <= 0) {
    mensagemDiv.textContent = "Quantidade inválida!";
    return;
  }
  
  const selecionados = pegarCodigosAleatorios(codigos[nivel], quantidade);
  
  let listaFormatada = selecionados.map((codigo, index) => `${index + 1} └──► ${codigo}`).join('\n');
  const mensagem = `✨ CÓDIGOS GERADOS ✨\n\n${listaFormatada}\n\n${quantidade} código(s) gerado(s).`;
  
  mensagemDiv.innerText = mensagem;
  
  const numero = '5571992290058';
  const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`;
  window.open(url, '_blank');
});
</script>

</body>
</html>

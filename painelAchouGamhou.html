<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel de Monitoramento - Saques</title>
<style>
  body { font-family: Arial; background: #f0f0f0; padding: 20px; }
  h1 { text-align: center; color: #333; }
  table { width: 100%; border-collapse: collapse; margin-top: 20px; background:white; }
  th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
  th { background: #0077cc; color: white; }
  tr:nth-child(even) { background: #f9f9f9; }
  #status { margin-top: 10px; text-align:center; }
</style>
</head>
<body>

<h1>Painel de Monitoramento de Saques</h1>
<p id="status">Conectando ao Firebase...</p>
<table>
  <thead>
    <tr>
      <th>Nome</th>
      <th>Pix</th>
      <th>Valor Saque (R$)</th>
      <th>WhatsApp</th>
      <th>Valor Compra (R$)</th>
      <th>Data/Hora</th>
    </tr>
  </thead>
  <tbody id="tabelaSaques">
    <!-- Linhas serÃ£o adicionadas dinamicamente -->
  </tbody>
</table>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  // Config Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyBw8nq_MTcdc91y0nG7jeTvROsAaz1Hj8U",
    authDomain: "geladeira-58de2.firebaseapp.com",
    databaseURL: "https://geladeira-58de2-default-rtdb.firebaseio.com",
    projectId: "geladeira-58de2",
    storageBucket: "geladeira-58de2.firebasestorage.app",
    messagingSenderId: "823625324816",
    appId: "1:823625324816:web:7c8a19cabd6461ff666d95",
    measurementId: "G-W547T81JCQ"
  };

  // Inicializa Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const tabela = document.getElementById("tabelaSaques");
  const status = document.getElementById("status");

  const saquesRef = ref(db, 'saques');

  // Recebe saques em tempo real
  onValue(saquesRef, snapshot => {
    const dados = snapshot.val();
    tabela.innerHTML = '';

    if (dados) {
      Object.values(dados).forEach(item => {
        const tr = document.createElement('tr');
        const data = new Date(item.data).toLocaleString();
        tr.innerHTML = `
          <td>${item.nome || '-'}</td>
          <td>${item.pix || '-'}</td>
          <td>${Number(item.valor).toFixed(2)}</td>
          <td>${item.whatsapp || '-'}</td>
          <td>${item.valorCompra || '-'}</td>
          <td>${data}</td>
        `;
        tabela.appendChild(tr);
      });
      status.textContent = `Total de saques: ${Object.keys(dados).length}`;
    } else {
      status.textContent = 'Nenhum saque registrado ainda.';
    }
  }, error => {
    status.textContent = 'Erro ao conectar ao Firebase.';
    console.error(error);
  });
</script>

</body>
</html>
